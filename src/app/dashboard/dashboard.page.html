<ion-header translucent="true">
  <ion-toolbar color="dark">
    <ion-title>ğŸ“Š Dashboard</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="dashboard-container">
    <!-- BotÃ£o de seleÃ§Ã£o de data -->
    <ion-button expand="block" color="primary" (click)="abrirModal()" class="data-btn">
      <ion-icon name="calendar-outline" slot="start"></ion-icon>
      {{ dataSelecionadaFormatada }}
    </ion-button>

    <!-- GrÃ¡fico -->
    <div *ngIf="lineChartData; else semDados" class="chart-card animate-fade-in">
      <canvas baseChart
        [data]="lineChartData"
        [options]="lineChartOptions"
        [type]="'line'">
      </canvas>
    </div>

    <ng-template #semDados>
      <p class="sem-dados animate-fade-in">Nenhum dado de histÃ³rico encontrado para esta data.</p>
    </ng-template>

    <!-- Lista de leituras -->
    <div *ngFor="let item of historicoDoDia" class="info-card animate-slide-up">
      <h3>ğŸ•’ {{ item.timestamp }}</h3>
      <p>ğŸŒ¡ï¸ <strong>Temperatura:</strong> {{ item.temperatura }}Â°C</p>
      <p>ğŸ’§ <strong>Umidade:</strong> {{ item.umidade }}%</p>
      <p>âš—ï¸ <strong>pH:</strong> {{ item.PH }}</p>
      <p *ngIf="item.status_bomba !== undefined">
        ğŸ’¡ <strong>Bomba:</strong>
        <span [ngClass]="item.status_bomba ? 'ligada' : 'desligada'">
          {{ item.status_bomba ? 'Ligada' : 'Desligada' }}
        </span>
      </p>
    </div>
  </div>
</ion-content>

<!-- Modal de data -->
<ion-modal [isOpen]="isModalOpen">
  <ng-template>
    <ion-content>
      <ion-datetime
        [value]="tempDataSelecionada"
        (ionChange)="dataMudouTemp($event)"
        presentation="date">
      </ion-datetime>

      <div class="modal-actions">
        <ion-button color="medium" (click)="cancelarModal()">Cancelar</ion-button>
        <ion-button color="primary" (click)="confirmarData()">Confirmar</ion-button>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
